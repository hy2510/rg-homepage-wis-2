import{R as P,r as h,j as S}from"./react-7d242ef7.js";import{c as b}from"./react-dom-d712bff1.js";import{a as d}from"./axios-a342f982.js";/* empty css                    */import"./babel-runtime-6c3dde2a.js";import"./core-js-8607efe6.js";import"./scheduler-765c72db.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function n(e){if(e.ep)return;e.ep=!0;const t=r(e);fetch(e.href,t)}})();const V="modulepreload",O=function(s){return"/public/"+s},T={},k=function(o,r,n){if(!r||r.length===0)return o();const e=document.getElementsByTagName("link");return Promise.all(r.map(t=>{if(t=O(t),t in T)return;T[t]=!0;const a=t.endsWith(".css"),i=a?'[rel="stylesheet"]':"";if(!!n)for(let l=e.length-1;l>=0;l--){const A=e[l];if(A.href===t&&(!a||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":V,a||(u.as="script",u.crossOrigin=""),u.href=t,document.head.appendChild(u),a)return new Promise((l,A)=>{u.addEventListener("load",l),u.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${t}`)))})})).then(()=>o()).catch(t=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=t,window.dispatchEvent(a),!a.defaultPrevented)throw t})},f="v1",J={LISTENING_1:"ListeningActivity1",LISTENING_2:"ListeningActivity2",LISTENING_3:"ListeningActivity3",LISTENING_4:"ListeningActivity4",VOCABULARY_1:"Vocabulary1",VOCABULARY_2:"Vocabulary2",VOCABULARY_3:"Vocabulary3",VOCABULARY_4:"Vocabulary4",VOCABULARY_PRACTICE_1:"VocabularyPractice1",VOCABULARY_PRACTICE_2:"VocabularyPractice2",VOCABULARY_PRACTICE_3:"VocabularyPractice3",VOCABULARY_PRACTICE_4:"VocabularyPractice4",VOCABULARY_TEST_1:"VocabularyTest1",VOCABULARY_TEST_2:"VocabularyTest2",VOCABULARY_TEST_3:"VocabularyTest3",VOCABULARY_TEST_4:"VocabularyTest4",READING_COMP_1:"ReadingComprehension1",READING_COMP_2:"ReadingComprehension2",READING_COMP_3:"ReadingComprehension3",READING_COMP_4:"ReadingComprehension4",SUMMARY_1:"Summary1",SUMMARY_2:"Summary2",TRUE_OR_FALSE:"TrueOrFalse",CLOZE_1:"ClozeTest1",CLOZE_2:"ClozeTest2",CLOZE_3:"ClozeTest3",WRITING_1:"WritingActivity1",WRITING_2:"WritingActivity2"},y="https://dev.readinggate.com:54000",X=async s=>{const o="study/save";return await d.post(`${y}/${f}/${o}`,s,{headers:{Authorization:p()}}).then(n=>n.data)},tt=async s=>{const o="study/save-partial-record";return console.log(s),await d.post(`${y}/${f}/${o}`,s,{headers:{Authorization:p()}}).then(n=>n.data)},et=async s=>{const o="study/save-writing";return await d.post(`${y}/${f}/${o}`,s,{headers:{Authorization:p()}}).then(n=>n.data)},st=async(s,o)=>await d.get(`${y}/${f}/study/record/${s}?studyId=${o.studyId}&studentHistoryId=${o.studentHistoryId}`,{headers:{Authorization:p()}}).then(n=>n.data),ot=async s=>await d.post(`${y}/${f}/study/clear-penalty`,s,{headers:{Authorization:p()}}).then(r=>r.data);async function rt(s,o){const r=`${y}/${f}/${s}`;let n;try{const e=await d.get(r,{headers:{Authorization:p()}});if(e.status>=200&&e.status<300){const t=e.data;n=await o(t)}else throw new Error("QuizData Load Failed 1")}catch(e){throw console.log(e),new Error("QuizData Load Failed 2")}return n}async function nt(s,o){const r=`${y}/${f}/${s}`;let n;try{const e=await d.get(r,{headers:{Authorization:p()}});if(e.status>=200&&e.status<300){const t=e.data;n=await o(t)}else throw new Error("API Load Failed 1")}catch(e){throw console.log(e),new Error("API Load Failed 2")}return n}async function z(s,o,r){const n=`${y}/${f}/study/${r}?studentHistoryId=${o}&studyId=${s}`;let e;try{const t=await d.get(n,{headers:{Authorization:p()}});if(t.status>=200&&t.status<300)e=await t.data;else throw new Error("API Load Failed 1")}catch(t){throw console.log(t),new Error("API Load Failed 2")}return e}async function B(s,o,r){const n=`${y}/${f}/library/book-info?studentHistoryId=${o}&studyId=${s}&levelRoundId=${r}`;let e;try{const t=await d.get(n,{headers:{Authorization:p()}});if(t.status>=200&&t.status<300)e=await t.data;else throw new Error("API Load Failed 1")}catch(t){throw console.log(t),new Error("API Load Failed 2")}return e}async function at(s,o){const r=`${y}/${f}/study/quiz/ebook-story?studentHistoryId=${o}&studyId=${s}`;let n;try{const e=await d.get(r,{headers:{Authorization:p()}});if(e.status>=200&&e.status<300)n=await e.data;else throw new Error("Get Story Data Failed 1")}catch(e){throw console.log(e),new Error("Get Story Data Failed 2")}return n}async function it(s,o,r){const n=`${y}/${f}/study/preference`;let e={success:!1};try{const t=await d.post(n,{studyId:s,studentHistoryId:o,preference:r},{headers:{Authorization:p(),"Content-Type":"application/json"}});if(t.status>=200&&t.status<300){const a=await t.data;if(a.success)e=a;else throw new Error("Post Preference Failed 1")}else throw new Error("Post Preference Failed 1")}catch(t){console.log(t)}return e}const p=()=>"Bearer "+window.REF.Token,U=P.createContext(void 0);function x({children:s}){const[o,r]=h.useState(!0),[n,e]=h.useState(),[t,a]=h.useState(),[i,w]=h.useState("story"),[u,l]=h.useState({id:0,cause:void 0}),[A,m]=h.useState(!1),[R,I]=h.useState(!1),[_,v]=h.useState(!1);if(h.useEffect(()=>{F().then(c=>{a(c),c.studyInfo.isSubmitPreference&&(w("quiz"),I(!0)),c.studyInfo.isStartSpeak&&w("speaking"),r(!1)}).catch(c=>{e(c)})},[]),n)return S.jsxs("div",{children:["Error: ",n.message]});if(o)return S.jsx("div",{children:"Loading ..."});const g={viewStudy:i,changeView:c=>{c==="quiz"&&(g.isPreference=!0,I(!0)),w(c)},finishStudy:{...u},actionFinishStudy:(c,L)=>{try{window.onFinishStudyResult(c.id,c.cause,L)}catch{location.replace("/")}},clearFinishStudyState:()=>{l({id:0,cause:void 0})},isShowBookInfo:A,setShowBookInfo:c=>{m(c)},isPreference:R,isReTest:_,changeReTest:c=>{v(c)}},E={...t,handler:{...g}};return console.log(E),S.jsx(U.Provider,{value:E,children:s})}function F(){return new Promise((s,o)=>{if(window){const r=window.REF,n=r.StudyId,e=r.StudentHistoryId,t=r.BookType,a=r.Mode,i=r.isStartSpeak,w=r.LevelRoundId,u=r.Token;N(n,e,t,a,i,w,u).then(l=>s(l)).catch(l=>{o(new Error(l.message))})}else o(new Error("Null Data"))})}async function N(s,o,r,n,e,t,a){try{const i=await Y(s,o,r);if(i){const w=n==="Super",u=i.isReview,l=i.isAvailableSpeaking,A=i.isListenAndRepeat,m=i.isSubmitPreference,R=i.allSteps,I=i.openSteps,_=i.mappedStepActivity,v=i.isQuizLearning,g=i.startStep,E=i.isPassedVocabularyPractice,c=i.availableQuizStatus,L=i.isReTestYn,C={studyId:s,studentHistoryId:o,bookType:r,mode:n,isSuper:w,isStartSpeak:e,isReview:u,isAvailableSpeaking:l,isListenAndRepeat:A,isSubmitPreference:m,allSteps:[...R],openSteps:[...I],mappedStepActivity:[..._],isQuizLearning:v,startStep:g,isPassedVocabularyPractice:E,availableQuizStatus:c,isReTestYn:L,token:a},$={...await D(s,o,t)};return{studyInfo:C,bookInfo:$}}else throw new Error("Get Study Info Failed")}catch(i){throw new Error(i.message)}}async function Y(s,o,r){return await z(s,o,r)}async function D(s,o,r){return await B(s,o,r)}function q(){const s=P.lazy(()=>k(()=>import("./StudyContainer-f6263bea.js"),["assets/StudyContainer-f6263bea.js","assets/react-7d242ef7.js","assets/babel-runtime-6c3dde2a.js","assets/core-js-8607efe6.js","assets/lodash-966e37b7.js","assets/react-lottie-d0c604de.js","assets/prop-types-387d7a00.js","assets/lottie-web-1d3b9245.js","assets/react-string-replace-0c479100.js","assets/react-dom-d712bff1.js","assets/scheduler-765c72db.js","assets/axios-a342f982.js","assets/StudyContainer-7bfa37c9.css","assets/animate-2d4c25b0.css"]));return S.jsx(x,{children:S.jsx(h.Suspense,{fallback:S.jsx("div",{}),children:S.jsx(s,{})})})}b.createRoot(document.getElementById("root")).render(S.jsx(P.StrictMode,{children:S.jsx(q,{})}));export{U as A,nt as a,tt as b,et as c,ot as d,J as e,it as f,rt as g,at as h,st as l,X as s};
